# Практическая работа №9 – Знакомство с облачными платформами IoT - Создание моделей и объектов
Модель объекта контроля - это формализованное представление устройства, подключаемого к платформе. В модели описываются параметры, которые отправляет устройство, и команды управления, которые оно может отработать. Единожды созданная модель может быть использована как для одного, так и для нескольких объектов, если они обладают одинаковым набором считываемых данных и выполняемых функций.

Если у вас есть три одинаковых датчика, передающих температуру и влажность, то нужно создать только одну модель, но три объекта (для каждого устройства)

Функции модели:
- поднимает уровень абстракции с уровня протоколов и аппаратной реализации до понятных человеку функций устройства, с которыми удобно работать без необходимости разбираться в протоколе. Преобразованные таким образом данные формируются в JSON, вид которого привычен для большинства разработчиков;
- автоматически рендерит интерфейс для визуализации данных от устройства;
- используется для формирования сценариев автоматизации и обработчиков данных.

Карточка модели
1.	Имя модели
2.	Описание модели
3.	Шаблон (используемый протокол передачи данных)
4.	Количество объектов с этой моделью. Нажмите на него, чтобы применить фильтр к списку объектов по данной модели

![](../images/Pasted%20image%2020241215214955.png)

### Создание модели устройства
Для создания новой модели перейдите на вкладку Модели. Добавьте модель, нажав на плюсик.
Заполните следующие поля:
•	имя — наименование модели;
•	описание — подробная характеристика модели, заполняется при необходимости;
•	импорт — возможность импортировать готовую модель в виде файла или по ссылке.

Выберите шаблон — заготовленную структуру модели. В платформу добавлено несколько готовых моделей, созданных на основе реализованных в ней протоколов. Модель создается по выбранному шаблону и включает в себя ряд аргументов, событий и действий, которые могут использоваться для устройств с таким протоколом. Вам остается только подстроить модель, добавляя, удаляя и конфигурируя узлы модели.
Также вместо создания новой модели можно воспользоваться одним из стартовых наборов.

Нажмите кнопку Создать. Перед вами откроется ваша новая модель. В левой части отображается древовидная структура модели, включающая в себя разнотипные узлы. В правой - окно редактирования выбранного узла.

![](../images/Pasted%20image%2020241215215039.png)

Параметры узлов модели

Сначала в каждом узле указывается его тип. В зависимости от выбранного типа формируются соответствующие поля формы для последующего заполнения. Типы:
- Подсистема - тип узла, который служит для организации структуры модели, позволяя объединять параметры в группы. Подсистема подразумевает, что данный узел содержит в себе несколько элементов в виде ответвлений древовидной структуры.
- Аргумент – это параметр, который передает устройство на платформу (например, текущее измерение сенсора). Аргументы могут быть числовыми, логическими, строковыми или представлять собой объект или массив. При этом для числовых аргументов можно указать единицу измерения, изображение и задать уровни.
- Конфигурация – это параметр, значение которого затем можно задать в интерфейсе объекта. Его можно использовать в работе автоматов и обработчиков. По своей сути, узлы с данным типом — это константы, которые необходимы для хранения дополнительной информации об объекте. Это может быть, к примеру, максимально допустимая температура, объем топливного бака, длительность работы и т.п.
- Действие – это операция, которая нужна для отправки команды на устройство или запуска автомата.
- Событие – это наступление определенных условий, которое либо было зафиксировано объектом, либо произошло во внешних по отношению к объекту контроля приложениях. События используются в автоматах при построении переходов между состояниями. Именно по произошедшим с объектом событиям эти переходы и происходят.

![](../images/Pasted%20image%2020241215215124.png)

У каждого типа есть пиктограмма, которая отображается слева от узла в дереве модели. Это позволяет визуально определять, к какому типу относится тот или иной узел.

Далее вводится уникальный по модели идентификатор и имя узла. Идентификатор необходим для распознавания узла в системе. Он является названием поля из данных о состоянии устройства при обращении к нему через API. Имя, в отличие от идентификатора, может быть неуникальным. Как идентификатор, так и имя генерируются при создании узла, их следует заменить на те идентификатор и имя, которые вам понятны и удобны.

Идентификатор должен быть уникальным! Идентификатор должен быть осмысленным! Идентификатор - для внутренней работы системы, имя - для интерфейса пользователя.
В платформе также заложены дополнительные функции для аргументов со специальными идентификаторами.

| Идентификатор параметра | Функция                                                                                                                                                                                                                   |
| ----------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `online`                | Статус подключения устройства: онлайн, подключено внешнее устройство онлайн, подключен бот платформы офлайн                                                                                                               |
| `_ts`                   | Время получения пакета данных от устройства (хранится в микросекундах UTC). Если в модели не используется параметр с идентификатором time, то его функции выполняет `_ts`                                                 |
| `time`                  | Время, по которому сортируются пакеты данных от устройства в истории, может отличаться от времени получения `_ts`. Часто используется, когда устройство параллельно с актуальной информацией высылает исторические данные |
| `lat, lon`              | Координаты перемещения объекта на карте                                                                                                                                                                                   |
|                         |                                                                                                                                                                                                                           |
|                         |                                                                                                                                                                                                                           |
|                         |                                                                                                                                                                                                                           |
